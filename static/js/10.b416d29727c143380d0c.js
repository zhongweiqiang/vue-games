webpackJsonp([10,39,61],{CiFk:function(t,e){},FrRF:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a,i=n("bOdI"),o=n.n(i),s=n("AaXs"),r=n("rxb8"),l=n("MArX"),c=n("CN/e"),d=n("/JS7"),u=n("xSRQ"),p=n("4vAe"),f={props:{onAdd:{type:Function,default:null}},components:{SaleAdd:p.default,StartTime:c.default,EndTime:d.default,MyModal:u.default},data:function(){return{formLayout:"horizontal",form:this.$form.createForm(this,{name:"coordinated"}),games:[],prices:[],users:[]}},created:function(){this.getUserList(),this.getGameList()},methods:(a={handleSubmit:function(t){var e=this;t.preventDefault(),this.form.validateFields(function(t,n){console.log(n),t||(console.log("Received values of form: ",n),e.$emit("search",n))})},filterOption:function(t,e){return e.componentOptions.children[0].text.toLowerCase().indexOf(t.toLowerCase())>=0},handleGameChange:function(t){console.log("selected "+t),t||this.form.setFieldsValue({price_id:void 0}),this.getPriceList(t)}},o()(a,"filterOption",function(t,e){return e.componentOptions.children[0].text.toLowerCase().indexOf(t.toLowerCase())>=0}),o()(a,"getGameList",function(){var t=this;Object(s.e)().then(function(e){t.games=e.data})}),o()(a,"getPriceList",function(t){var e=this;Object(r.g)({game_id:t}).then(function(t){e.prices=t.data})}),o()(a,"getUserList",function(t){var e=this;Object(l.g)().then(function(t){e.users=t.data})}),a)},m={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("a-row",[t.hasPermission("sale.add")?n("a-col",{staticStyle:{height:"58px","margin-left":"10px"},attrs:{xs:20,sm:16,md:10,lg:3,xl:3}},[n("a-row",[n("a-col",{staticStyle:{"margin-top":"10px"}},[n("sale-add",{attrs:{"on-add":t.onAdd}})],1),t._v(" "),n("a-col",[n("my-modal")],1)],1)],1):t._e(),t._v(" "),n("a-col",{attrs:{span:20}},[n("a-form",{attrs:{form:t.form,layout:"inline"},on:{submit:t.handleSubmit}},[n("a-row",{staticStyle:{height:"30px","margin-left":"10px"}},[n("a-col",{attrs:{span:22}},[n("a-row",[n("a-col",{staticStyle:{"margin-top":"10px"},attrs:{span:6,xs:20,sm:16,md:10,lg:6,xl:6}},[n("a-form-item",[n("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["game_id"],expression:"['game_id']"}],staticStyle:{width:"160px"},attrs:{showSearch:"",placeholder:"选择游戏",optionFilterProp:"children",filterOption:t.filterOption,allowClear:"",size:"small"},on:{change:t.handleGameChange}},t._l(t.games,function(e){return n("a-select-option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name))])}),1)],1)],1),t._v(" "),n("a-col",{staticStyle:{"margin-top":"10px"},attrs:{span:6,xs:20,sm:16,md:10,lg:6,xl:6}},[n("a-form-item",[n("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["status"],expression:"['status']"}],staticStyle:{width:"160px"},attrs:{showSearch:"",placeholder:"订单状态",allowClear:"",size:"small"}},[n("a-select-option",{attrs:{value:"1"}},[t._v("正常挂单")]),t._v(" "),n("a-select-option",{attrs:{value:"2"}},[t._v("部分交易")])],1)],1)],1)],1),t._v(" "),n("a-row",{style:{marginTop:"10px"}},[n("a-col",{staticStyle:{"margin-top":"10px"},attrs:{span:5,xs:20,sm:16,md:10,lg:6,xl:6}},[n("a-form-item",[n("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["price_id"],expression:"['price_id']"}],staticStyle:{width:"160px"},attrs:{showSearch:"",placeholder:"选择面值",optionFilterProp:"children",filterOption:t.filterOption,allowClear:"",size:"small"}},t._l(t.prices,function(e){return n("a-select-option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.gold))])}),1)],1)],1),t._v(" "),n("a-col",{staticStyle:{"margin-top":"10px"},attrs:{span:6,xs:20,sm:16,md:10,lg:6,xl:5}},[n("a-form-item",[n("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["user_id"],expression:"['user_id']"}],staticStyle:{width:"160px"},attrs:{showSearch:"",placeholder:"选择用户",optionFilterProp:"children",filterOption:t.filterOption,allowClear:"",size:"small"}},t._l(t.users,function(e){return n("a-select-option",{key:e.user_id,attrs:{value:e.user_id}},[t._v(t._s(e.nickname))])}),1)],1)],1)],1)],1),t._v(" "),n("a-col",{staticStyle:{"margin-top":"10px"},style:{display:"flex",justifyItems:"center",alignItems:"center",height:"58px"},attrs:{span:6,xs:20,sm:16,md:10,lg:1,xl:1,offset:1}},[n("a-form-item",[n("a-button",{attrs:{size:"small",type:"primary","html-type":"submit"}},[t._v("搜索")])],1)],1)],1)],1)],1)],1)},staticRenderFns:[]};var h=n("VU/8")(f,m,!1,function(t){n("CiFk")},"data-v-bdaabae6",null);e.default=h.exports},QUQc:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});n("Bbw+");var a=n("DAs4"),i=n("AWGc"),o=n("vSJi"),s={props:{id:{type:Number,default:null},info:{type:Object,default:null},onBuy:{type:Function,default:null}},components:{BuyModal:i.default,SaleEdit:o.default},mounted:function(){},data:function(){return{user_id:this.$store.getters.info.id}},methods:{handleButtonClick:function(t){console.log("click left button",t)},handleMenuClick:function(t){switch(console.log("click",t.key),Number(t.key)){case 1:this.buy_store();break;case 2:this.down(this.id);break;case 3:this.update_store()}},down:function(t){this.$createElement;var e=this;this.$confirm({title:"确认下架?",content:function(t){return t("div",{style:"color:red;"},["下架后可重新上架"])},onOk:function(){Object(a.e)({id:t}).then(function(t){e.$message.success(t.message),e.$emit("update")})},onCancel:function(){e.$message.info("取消下架")}})},buy_store:function(){this.$refs.buy.visible=!0},update_store:function(){this.$refs.edit.showModal()}}},r={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{style:{display:"inline"}},[n("a-dropdown",{attrs:{placement:"bottomRight"}},[n("a-menu",{attrs:{slot:"overlay"},on:{click:t.handleMenuClick},slot:"overlay"},[t.user_id!=t.info.user_id?n("a-menu-item",{key:"1"},[n("buy-modal",{ref:"buy",attrs:{info:t.info,"on-buy":t.onBuy}})],1):t._e(),t._v(" "),t.user_id==t.info.user_id?n("a-menu-item",{key:"2"},[n("div",[n("a-icon",{attrs:{type:"money"}}),t._v("下架\n        ")],1)]):t._e(),t._v(" "),t.user_id==t.info.user_id?n("a-menu-item",{key:"3"},[n("sale-edit",{ref:"edit",attrs:{info:t.info,"on-update":t.onBuy}})],1):t._e()],1),t._v(" "),n("a-button",{staticStyle:{"margin-left":"8px"},attrs:{size:"small",type:"primary"}},[t._v("\n      操作\n      "),n("a-icon",{attrs:{type:"down"}})],1)],1)],1)},staticRenderFns:[]},l=n("VU/8")(s,r,!1,null,null,null);e.default=l.exports},VPe8:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n("Dd8w"),i=n.n(a),o=n("DAs4"),s=n("FrRF"),r=n("QUQc"),l=[{title:"id",dataIndex:"id",sorter:!0,align:"center",fixed:"left"},{title:"用户账户",key:"user",align:"center",scopedSlots:{customRender:"user"},fixed:"left"},{title:"游戏名称",key:"game",align:"center",scopedSlots:{customRender:"game"}},{title:"面值名称",key:"price",align:"center",scopedSlots:{customRender:"price"}},{title:"发布数量",dataIndex:"unit",align:"center"},{title:"订单单价",dataIndex:"unit_price",align:"center"},{title:"订单总价",key:"total_money",align:"center",scopedSlots:{customRender:"total_money"}},{title:"状态",dataIndex:"status",align:"center"},{title:"发布时间",dataIndex:"created_at",align:"center"},{title:"操作",key:"action",scopedSlots:{customRender:"action"},align:"center",fixed:"right"}],c={components:{OnSearch:s.default,DropDown:r.default},beforeCreate:function(){this.form=this.$form.createForm(this,{name:"normal_login"})},data:function(){return{data:[],pagination:{pageSize:12},loading:!1,columns:l,selectedRowKeys:[],name:"",filters:{},search:{}}},mounted:function(){this.fetch({pageSize:this.pagination.pageSize}),console.log(this.config)},methods:{onSearch:function(t){this.search=t,this.fetch(i()({},t,{pageSize:this.pagination.pageSize}))},onUpdate:function(){this.fetch(i()({},this.getPagination(),this.search))},buy:function(){this.onUpdate()},getPagination:function(){return{pageSize:this.pagination.pageSize,page:this.pagination.current,sortField:this.pagination.sortField,sortOrder:this.pagination.sortOrder}},status:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t){var e=this;status({id:t}).then(function(t){e.fetch(e.getPagination())})}),handleTableChange:function(t,e,n){var a=i()({},this.pagination);a.current=t.current,a.sortField=n.field,a.sortOrder=n.order,this.pagination=a,this.filters=e,this.fetch(i()({pageSize:t.pageSize,page:t.current,sortField:n.field,sortOrder:n.order},e,this.search))},fetch:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.loading=!0,Object(o.g)(e).then(function(e){console.log(e.data);var n=i()({},t.pagination),a=e.data;t.data=a.data,n.total=a.total,t.pagination=n,t.loading=!1})},destroyAll:function(){this.$destroyAll()},onSelectChange:function(t){console.log("selectedRowKeys changed: ",t),this.selectedRowKeys=t}}},d={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("a-row",{staticStyle:{"z-index":"2"}},[n("a-col",{attrs:{span:22}},[n("on-search",{attrs:{"on-add":t.onUpdate},on:{search:t.onSearch}})],1),t._v(" "),n("a-col",{staticStyle:{"margin-top":"17px"},attrs:{span:2}})],1),t._v(" "),n("a-row",[n("a-col",{staticStyle:{"margin-top":"20px"}},[n("a-table",{attrs:{columns:t.columns,rowKey:function(t){return t.id},dataSource:t.data,pagination:t.pagination,loading:t.loading,scroll:{x:800}},on:{change:t.handleTableChange},scopedSlots:t._u([{key:"user",fn:function(e){return n("span",{},[t._v(t._s(e.user.nickname))])}},{key:"game",fn:function(e){return n("span",{},[t._v(t._s(e.game.name))])}},{key:"price",fn:function(e){return n("span",{},[t._v(t._s(e.price.gold))])}},{key:"total_money",fn:function(e){return n("span",{},[t._v(t._s(e.unit*e.unit_price))])}},{key:"owner_user_id",fn:function(e){return n("span",{},[e.son?n("div",[t._v(t._s(e.son.name))]):n("div",[t._v(t._s(e.user.name))])])}},{key:"action",fn:function(e){return n("span",{},[n("drop-down",{attrs:{id:e.id,info:e,"on-buy":t.buy,status:e.status},on:{update:t.onUpdate}})],1)}}])})],1)],1),t._v(" "),n("a-divider")],1)},staticRenderFns:[]};var u=n("VU/8")(c,d,!1,function(t){n("pzsn")},null,null);e.default=u.exports},pzsn:function(t,e){}});
//# sourceMappingURL=10.b416d29727c143380d0c.js.map